<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.comicbookreader">

<body>
  <metal:content-core fill-slot="content-core">
     <metal:block define-macro="content-core"
            tal:define="Batch python:modules['Products.CMFPlone'].Batch;
                        content_type context/get_content_type|context/Format;
                        b_size python:2; b_size request/b_size | b_size;
                        b_start python:0;b_start request/b_start | b_start;
                        order python:1;order request/order | order;
                        images view/listImageFiles;
                        batch python:Batch(images, int(b_size), int(b_start), orphan=1);">

       <span class="discreet" i18n:translate="">You can use left/right arrows to navigate the book</span>
       <div class="cbr-controls" style="float:right;">
         <a href="#"
            title="Switch to Single View"
            tal:condition="python: b_size > 1"
            tal:attributes="href python: context.absolute_url() + '/view?b_size:int=1&b_start:int=' + str(b_start)">
           <img alt="Single View"
                tal:attributes="src python: context.portal_url() + '/++resource++collective.comicbookreader.images/double-face.png';" />
         </a>
         <a href="#"
            title="Switch to Dual View"
            tal:condition="python: b_size < 2"
            tal:attributes="href python: context.absolute_url() + '/view?b_size:int=2&b_start:int=' + str(b_start)">
           <img alt="Double View"
                tal:attributes="src python: context.portal_url() + '/++resource++collective.comicbookreader.images/single-face.png';" />
         </a>
         <img alt="Single View" title="Normal Mode" tal:condition="python: b_size < 2"
                tal:attributes="src python: context.portal_url() + '/++resource++collective.comicbookreader.images/single.png';" />
         <a href="#"
           condition="python:b_size > 1 and order != -1"  
           title="Switch to Reversed Mode"
           tal:condition="python: b_size > 1 and order != -1"
           tal:attributes="href python: context.absolute_url() + '/view?order:int=-1&b_start:int=' + str(b_start)">

           <img alt="Reversed View"
                tal:attributes="src python: context.portal_url() + '/++resource++collective.comicbookreader.images/normal.png';" />
         </a>
         <a href="#"
           title="Switch to Normal Mode"
           class="cbr-mode-reverted-active"
           tal:condition="python:b_size > 1 and order != 1"
           tal:attributes="href python: context.absolute_url() + '/view?b_start:int=' + str(b_start) + '&order:int=1'">
           <img alt="Normal View"
                   tal:attributes="src python: context.portal_url() + '/++resource++collective.comicbookreader.images/reverted.png';" />
         </a>
         </div>
         <div class="visualClear"><!-- --></div>
         <div id="cbr-preview">
             <div id="top-batch-controlbar">
                <div id="top-batch-controlbar" metal:use-macro="context/batch_macros/macros/navigation" />
             </div>
             <div tal:define="ordered_images python: [i for i in batch]"
                 tal:repeat="image python: order == -1 and ordered_images[::-1] or ordered_images">
                 <img style="max-width:48%; max-height: 500px; float:left"
                     tal:attributes="src python: context.absolute_url() + '/' + image['url'];" />
             </div>
             <div class="visualClear"><!-- --></div>
         </div>
        </metal:block>
    </metal:content-core>

</body>

</html>

